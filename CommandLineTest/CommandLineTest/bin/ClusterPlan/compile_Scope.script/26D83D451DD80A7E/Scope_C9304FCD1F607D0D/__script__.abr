<?xml version="1.0" encoding="utf-8"?>
<ScriptAndGraph GraphType="NebulaAlgebra" SignatureVersion="1">
  <graph JsonErrors="True" JobType="BatchScopeServerGC" SStreamInfoFilePath="__SStreamInfo__.xml" vertexExecutable="scopehost.exe" BroadcastCopyThroughCommandLine="ScopeEngine.dll -scopeVertex SV_CopyThrough">
    <process id="SV1_Extract_Split" command="ScopeEngine.dll -scopeVertex SV1_Extract_Split" nativeOnly="true" managedMemorySize="0" engineIOMemorySize="3642754168" engineOperatorMemorySize="2048576352">
      <input id="Extract_0[ALL]" streamSize="3398" cosmosStream="adl://sandbox-c09.azuredatalakestore.net/users/v-hozhao/SampleScope/SearchLog.txt">
        <cosmosStream cosmosPath="adl://sandbox-c09.azuredatalakestore.net/users/v-hozhao/SampleScope/SearchLog.txt" streamSize="3398" />
      </input>
      <output id="SV1_Extract_Split_out0" />
      <output id="SV1_Extract_Split_out1" />
      <output id="SV1_Extract_Split_out2" cosmosStream="vc://cosmos09/cosmosAdmin/users/v-hozhao/SampleScope/zhao/SampleOutput.txt" />
    </process>
    <process id="SV2_Aggregate" command="ScopeEngine.dll -scopeVertex SV2_Aggregate" nativeOnly="true" managedMemorySize="0" engineIOMemorySize="947912704" engineOperatorMemorySize="524288000">
      <input id="SV1_Extract_Split_out1" />
      <output id="SV2_Aggregate_out0" />
    </process>
    <dataset id="Concatenate_6[]" cosmosStream="vc://cosmos09/cosmosAdmin/users/v-hozhao/SampleScope/SampleOutput.ss">
      <element id="SV1_Extract_Split_out0" />
      <element id="SV2_Aggregate_out0" />
    </dataset>
  </graph>
  <Scopescript>REFERENCE @"C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\System.Core.dll";
//Script GUID:5adde967-79c5-479c-a4b1-dd6580d22770
//Used for tracking history


searchlog =
    EXTRACT UserId : int,
            Start : DateTime,
            Region : string,
            Query : string,
            Duration : int,
            Urls : string,
            ClickedUrls : string
    FROM @"/users/v-hozhao/SampleScope/SearchLog.txt"
    USING DefaultTextExtractor();
                                                                                           
OUTPUT searchlog
TO "/users/v-hozhao/SampleScope/zhao/SampleOutput.txt"
USING DefaultTextOutputter(); 

OUTPUT searchlog
TO SSTREAM @"/users/v-hozhao/SampleScope/SampleOutput.ss";  

// Generated by ScopeStudio, version 2.9.0000.1
</Scopescript>
  <Optimization succeeded="true" time="00:00:00.2304723" latency="0.0262366827027027" totalCost="0.0524733654054054" />
  <ScopeVertexAnnotations />
</ScriptAndGraph>